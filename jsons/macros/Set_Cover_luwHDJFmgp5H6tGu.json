{
  "name": "Set Cover",
  "type": "script",
  "scope": "global",
  "author": "nx29hoGineoQv9Bs",
  "img": "icons/svg/tower-flag.svg",
  "command": "// Macro to measure cover between selected tokens and targets.\n// And allow the user to set cover status.\nconst api = game.modules.get(\"tokenvisibility\").api;\nconst CoverCalculator = api.CoverCalculator;\nconst CoverDialog = api.CoverDialog\n\n// Determine token and targets.\nconst token = game.user._lastSelected;\nconst targets = game.user.targets;\nif ( !token ) {\n  ui.notifications.error(\"Please select a token.\");\n  return;\n}\nif ( !targets.size ) {\n  ui.notifications.error(\"Please target at least one target.\");\n  return;\n}\n\n// Request the user confirm cover, and then update target statuses.\nconst coverDialog = new CoverDialog(token, targets)\nconst coverCalculations = await coverDialog.confirmCover()\nawait coverDialog.updateTargetsCover(coverCalculations);\n\n// Send cover message to chat.\nawait coverDialog.sendCoverCalculationsToChat({ coverCalculations })",
  "folder": null,
  "ownership": {
    "default": 0,
    "nx29hoGineoQv9Bs": 3
  },
  "flags": {
    "core": {}
  },
  "_stats": {
    "systemId": "dnd5e",
    "systemVersion": "2.3.0",
    "coreVersion": "11.308",
    "createdTime": 1681164760491,
    "modifiedTime": 1693946390903,
    "lastModifiedBy": "nx29hoGineoQv9Bs"
  },
  "_id": "luwHDJFmgp5H6tGu",
  "sort": 100000,
  "_key": "!macros!luwHDJFmgp5H6tGu"
}
